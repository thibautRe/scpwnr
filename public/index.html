<!DOCTYPE html>
<html>
<head>
  <title>Sup</title>
</head>
<body>

<form action="/song">
    <input name="url"/>
    <button type="submit">Convertir</button>
</form>

<script type="text/javascript" src="/vendor/zepto/zepto.js"></script>
<script type="text/javascript" src="/scripts/scpwnr-client.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
  var io = io.connect();

  var message = function(mess) {
    $('body').append('<div>' + mess + '</div>')
  };

  // Listen for the talk event.
  io.on('conv-finish', function(data) {
    message('Conversion finished');
  });
  io.on('conv-prog', function(data) {
    message('Conversion : progression ' + data.percent + "%");
  });
  io.on('conv-error', function(data) {
    message('Conversion error !');
  });

  var requestForm = $('form');

  // on submit
  requestForm.submit(function() {
    var url = requestForm.serializeArray()[0].value;
    message(getUrlType(url));

    io.emit('conv-request', {
      url: url,
      type: getUrlType(url)
    });

    message('Conversion begin...');
    return false;
  });

</script>
</body>